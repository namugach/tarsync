# Changelog

모든 주요 변경 사항이 이 파일에 기록됩니다.

## [1.1.0] - 2025-08-02

### ✨ 새로운 기능

#### 📋 독립적인 로그 명령어 추가
- **새로운 `log` 명령어**: 백업의 메모와 로그를 별도 명령어로 조회
- **간소화된 `list` 명령어**: 복잡한 선택 기능 제거, 순수 목록 표시에 집중
- **일관된 사용자 경험**: list와 restore 명령어 간 표시 형식 통일

#### 🔧 로그 시스템 개선
- **JSON 로그 형식**: 기존 Markdown에서 JSON 형식으로 변경 (`log.json`)
- **AM/PM 시간 형식**: 더 직관적인 시간 표시 방식 적용
- **분리된 메모 시스템**: 사용자 메모를 별도 파일로 관리 (`note.md`)

#### 🎯 사용자 인터페이스 개선
- **메모 아이콘 표시**: 목록에서 메모 존재 여부를 📝/❌ 아이콘으로 표시
- **명령어 구조 단순화**: 복잡한 파라미터 조합 제거
- **고급 페이지네이션**: 음수 페이지 번호로 마지막 페이지부터 역순 탐색 지원
- **자동완성 업데이트**: 새로운 log 명령어에 대한 bash/zsh 자동완성 지원

### 🔄 변경사항

#### 명령어 구조 변경
- **이전**: `tarsync list 10 1 3` (선택 기능 포함)
- **새로운**: `tarsync list 10 1` + `tarsync log 3` (명령어 분리)

#### 백업 데이터 구조 업데이트
```
백업 디렉토리/
├── tarsync.tar.gz    # 압축된 백업 파일
├── meta.sh           # 메타데이터
├── log.json          # 백업 로그 (JSON 형식) - 변경
└── note.md           # 사용자 메모 (선택적) - 신규
```

#### 시간 형식 개선
- **이전**: `2025_01_15_오후_02_30_45`
- **새로운**: `2025_08_02_PM_04_16_40` (AM/PM 형식)

### 🛠️ 기술적 개선

#### 모듈 아키텍처 개선
- **list.sh 모듈**: `show_backup_log()` 함수 추가로 로그 조회 기능 분리
- **코드 중복 제거**: 백업 목록 표시 로직 통일
- **에러 처리 강화**: 로그 명령어에 대한 포괄적인 검증 로직 추가

#### 자동완성 시스템 업그레이드
- **bash.sh**: log 명령어 자동완성 추가, 백업 이름 완성 로직 개선
- **zsh.sh**: log 명령어 지원, 백업 디렉토리 자동 탐지 기능 강화

### 📚 문서 업데이트

#### 사용자 문서 전면 개편
- **README.md**: 새로운 명령어 구조 반영, 예시 업데이트
- **MANUAL.md**: log 명령어 상세 설명 추가, 백업 구조 업데이트
- **CLAUDE.md**: 개발 가이드 업데이트, 새로운 테스트 명령어 추가

#### 예시 및 사용법 개선
```bash
# 백업 목록 보기
tarsync list

# 고급 페이지네이션 (마지막 페이지부터)
tarsync list 2 -1

# 특정 백업의 로그와 메모 보기
tarsync log 1
tarsync log 2025_08_02_PM_04_16_40
```

### 🐛 버그 수정

#### 일관성 문제 해결
- **목록 순서 불일치**: list와 restore 명령어 간 백업 순서 통일
- **파라미터 처리**: 복잡한 선택 파라미터로 인한 사용자 혼란 해결
- **아이콘 표시**: 백업 상태와 메모 존재 여부 표시 일관성 확보

### 💡 사용성 개선

#### 직관적인 워크플로우
1. `tarsync list` - 백업 목록 확인
2. `tarsync log <번호>` - 관심 있는 백업의 상세 정보 확인
3. `tarsync restore <번호>` - 필요시 백업 복구

#### 명확한 명령어 분리
- **list**: 순수 목록 표시 기능
- **log**: 로그 및 메모 조회 전용
- **restore**: 복구 작업 전용
- **delete**: 삭제 작업 전용
- **details**: 상세 정보 조회 전용

### ⚡ 성능 개선

#### 메모리 효율성
- **JSON 로그**: 구조화된 데이터로 파싱 성능 향상
- **분리된 메모**: 선택적 메모 로딩으로 불필요한 I/O 감소

---

## [1.0.0] - 2025-01-01

### 🎉 초기 릴리스

**Tarsync의 첫 번째 공식 릴리스입니다!**

### ✨ 주요 기능

#### 🗜️ 압축 백업 시스템
- **tar + gzip 기반 압축 백업**: 효율적인 압축으로 저장 공간 최적화
- **스트리밍 압축**: 메모리 효율적인 파이프라인 처리
- **권한 보존**: ACL, 확장 속성, 하드링크 완전 보존
- **진행률 표시**: pv(pipe viewer)를 통한 실시간 진행률 모니터링

#### 🔄 안전한 복구 시스템
- **이중 복구 모드 지원**:
  - **안전 복구**: 기존 파일 보존하며 백업 내용 추가/업데이트
  - **완전 동기화**: 백업 시점과 완전히 동일한 상태로 복구
- **rsync 기반 동기화**: 안정적이고 검증된 파일 동기화
- **복구 로그 시스템**: 모든 복구 작업에 대한 상세 로그 기록

#### 📋 백업 목록 관리
- **페이지네이션 지원**: 대량의 백업도 효율적으로 조회
- **백업 선택 기능**: 특정 백업의 로그 내용 즉시 확인
- **백업 삭제/상세정보**: 개별 백업 관리 기능
- **무결성 검사**: 백업 파일 상태 자동 확인

#### 📝 메타데이터 시스템
- **완전한 백업 정보 기록**: 크기, 날짜, 제외경로, 압축률 등
- **로그 시스템**: 사용자 편집 가능한 백업 로그 생성
- **백업 검증**: 자동 무결성 검사 및 상태 표시

### 🛠️ 핵심 모듈

#### 백업 모듈 (`src/modules/backup.sh`)
- 전체 시스템 또는 지정 경로 압축 백업
- 실시간 진행률 표시 및 용량 계산
- 사용자 편집 가능한 로그 파일 생성
- 자동 메타데이터 생성 및 관리

#### 복구 모듈 (`src/modules/restore.sh`)
- 인터랙티브 백업 선택 시스템
- 두 가지 복구 모드 (안전/완전동기화)
- 자동 압축 해제 및 rsync 동기화
- 복구 과정 전체에 대한 상세 로깅

#### 목록 관리 모듈 (`src/modules/list.sh`)
- 페이지네이션을 통한 효율적인 목록 표시
- 백업 선택 및 로그 내용 표시
- 백업 삭제 및 상세 정보 확인
- 백업 무결성 상태 실시간 검사

#### 공통 유틸리티 (`src/modules/common.sh`)
- 설정 로드 및 경로 관리
- 메타데이터 생성 및 로드
- 파일 크기 계산 및 형식 변환
- 디렉토리 구조 자동 생성

### 🔧 유틸리티 시스템

#### 설정 관리 (`src/utils/config.sh`)
- 기본 설정값 로드 시스템
- 제외 경로 관리
- 백업 대상 및 저장소 경로 설정

#### 검증 시스템 (`src/utils/validation.sh`)
- 필수 도구 존재 확인 (tar, gzip, rsync, pv)
- 백업 대상 유효성 검사
- 저장소 용량 및 권한 확인
- 백업 파일 무결성 검증

#### 포맷팅 (`src/utils/format.sh`)
- 파일 크기 자동 변환 (B, KB, MB, GB, TB)
- 날짜/시간 형식 통일
- 백업 디렉토리명 자동 생성

#### 로깅 시스템 (`src/utils/log.sh`)
- 구조화된 로그 출력
- 타임스탬프 자동 추가
- 색상 코딩으로 로그 레벨 구분

#### 색상 시스템 (`src/utils/colors.sh`)
- 일관된 색상 테마 적용
- 상태별 색상 코딩 (성공/경고/오류)
- 터미널 호환성 확보

### 📁 백업 구조

```
BACKUP_PATH/
├── store/                          # 백업 저장소
│   └── 2025_01_01_오후_02_30_45/    # 백업 디렉토리 (날짜별)
│       ├── tarsync.tar.gz          # 압축된 백업 파일
│       ├── meta.sh                 # 메타데이터
│       └── log.md                  # 백업 로그 (선택사항)
└── restore/                        # 복구 작업 로그
    └── restore_logs/               # 복구 로그 보관
```

### 🎯 설계 철학

#### 사용자 중심 디자인
- **직관적인 인터페이스**: 복잡한 옵션 없이 간단한 명령어 구조
- **실시간 피드백**: 모든 주요 작업에 진행률 및 상태 표시
- **안전성 우선**: 데이터 손실 방지를 위한 다중 검증 시스템

#### 모듈화 및 확장성
- **명확한 책임 분리**: 각 모듈이 특정 기능에만 집중
- **공통 유틸리티**: 중복 코드 제거 및 일관성 확보
- **설정 중심**: 코드 변경 없이 동작 커스터마이징 가능

#### 성능 최적화
- **스트리밍 처리**: 메모리 효율적인 파이프라인 처리
- **병렬 처리**: tar와 압축을 동시에 수행
- **스마트 제외**: 불필요한 파일 자동 제외로 성능 향상

### 🔧 시스템 요구사항

**필수 도구**:
- `tar` - 아카이브 생성/해제
- `gzip` - 압축/해제  
- `rsync` - 파일 동기화
- `pv` - 진행률 표시

**권한**:
- 시스템 백업을 위한 sudo 권한
- 백업 저장소 쓰기 권한

**운영체제**:
- Linux 기반 시스템 (Ubuntu, CentOS, Debian 등)

### 📚 문서화

#### 사용자 문서
- **README.md**: 프로젝트 소개 및 빠른 시작 가이드
- **docs/MANUAL.md**: 상세한 사용자 매뉴얼
- **docs/meta/DESCRIPTION.md**: 프로젝트 상세 설명

#### 개발자 가이드
- 모듈별 상세 주석
- 함수별 역할 및 인터페이스 문서화
- 설정 파일 구조 설명

### 🚀 사용 시나리오

#### 시스템 관리자
```bash
# 전체 시스템 정기 백업
./bin/backup

# 백업 목록 관리
./bin/list

# 시스템 복구
./bin/restore
```

#### 개발자
```bash
# 프로젝트 디렉토리 백업
./bin/backup /home/user/projects

# 특정 백업으로 복구
./bin/restore 3 /home/user/recovery
```

#### 데이터 센터
```bash
# 대용량 서버 백업
BACKUP_PATH="/mnt/backup-storage" ./bin/backup /

# 백업 무결성 일괄 확인
./bin/list ls 0 1  # 전체 목록 확인
```

### 🛡️ 보안 및 안정성

#### 데이터 보호
- **권한 완전 보존**: ACL, 확장 속성, 소유권 보존
- **원자성 보장**: 백업 실패 시 자동 정리
- **무결성 검증**: 백업 파일 자동 검사

#### 오류 처리
- **graceful degradation**: 부분 실패 시에도 안전한 종료
- **상세 로깅**: 문제 진단을 위한 완전한 로그 기록
- **롤백 지원**: 실패한 작업의 자동 정리

### 🔮 향후 계획

#### v1.1.0 계획
- **원격 백업 지원**: SSH, FTP를 통한 원격 저장소 백업
- **증분 백업**: 변경된 파일만 백업하는 증분 백업 지원
- **백업 스케줄링**: cron 통합을 통한 자동 백업 스케줄링

#### v1.2.0 계획
- **암호화 지원**: GPG를 통한 백업 파일 암호화
- **압축 알고리즘 선택**: gzip 외 다양한 압축 알고리즘 지원
- **GUI 도구**: 웹 기반 관리 인터페이스

#### v2.0.0 계획
- **클러스터 지원**: 분산 환경에서의 백업 관리
- **클라우드 통합**: AWS S3, Google Cloud Storage 연동
- **데디스플리케이션**: 중복 제거를 통한 저장 공간 최적화

---

**Tarsync v1.0.0**은 안정적이고 사용하기 쉬운 백업 솔루션을 제공합니다. 
시스템 관리자부터 개발자까지, 모든 사용자가 신뢰할 수 있는 백업 도구가 되겠습니다.